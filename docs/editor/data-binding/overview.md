---
title: "数据绑定概览 (Data Binding Overview)"
description: "使用视图模型将编辑器元素连接到数据和代码"
---

# 什么是数据绑定？

数据绑定是一种在编辑器元素、数据和代码之间创建响应式连接的强大方式。例如，您可以：

- 将图标的颜色绑定颜色数据属性，以便开发者在运行时进行调整
- 绑定动画对象的 X 轴位置，以便另一个对象可以带偏移量地跟随它
- 监听两个按钮上的点击事件，以增加或减少计数器

# 为什么要使用数据绑定？

数据绑定通过引入双方都可以绑定的中间数据，实现了设计和代码的解耦。这构成了设计师和开发者之间的"合同"。一旦这份合同就位，双方都可以独立进行迭代，从而加快您交付新功能和尝试各种可能性的能力。

在编辑器内部，数据绑定允许您的设计具有更强的响应性。您可以建立对象之间的关系，并确保无论画板处于何种状态，某些约束条件始终成立。数据绑定系统将确保这些关系在动画和代码更改数值时始终保持最新。

它还提供了将更多逻辑从代码移入 Rive 文件的机会。您需要根据具体用例决定逻辑应该存在于代码中还是数据绑定中，但一个考量因素是：任何数据绑定逻辑在各个运行时都是通用的，而不需要重复实现。

# 入门视频

以下视频系列通过对编辑器的引导式演示来介绍数据绑定，这将有助于巩固下述概念。

### 简介

<YouTube videoId="M6goAzrDop4" />

### 视图模型 (View Models)

<YouTube videoId="WSkg8kgTR20" />

### 数字属性 (Number Properties)

<YouTube videoId="xmpLMhtKwbI" />

### 字符串属性 (String Properties)

<YouTube videoId="qJRrSmz-W48" />

### 颜色属性 (Color Properties)

<YouTube videoId="TSEiU1zpSL0" />

### 绑定状态机条件

<YouTube videoId="VJ9jk0RLc-s" />

# 术语表

数据绑定引入了许多您需要熟悉的词汇。这些概念的名称大致源自软件开发中的 Model, View, Viewmodel (MVVM) 模式。

### 编辑器元素 (Editor Element)

就数据绑定而言，"编辑器元素"仅指编辑器中具有可附加绑定的数值的可编辑 UI 元素。

### 视图模型 (View Model)

视图模型是数据集合的蓝图。开发者可以将其视为类似于面向对象编程中的"类"（Class）。视图模型通常描述了与给定用例相关联的所有数据——通常每个画板一个。视图模型本身没有具体数值。为此，您必须拥有[一个实例](#视图模型实例)。

### 视图模型属性 (View Model Property)

视图模型属性是视图模型中的一条数据。开发者可以将其视为类似于面向对象编程中的"字段"（Field）。属性在创建时会选择数据类型，并具有可在代码中引用的名称。每个属性都可以绑定到相同类型的不同编辑器元素。

### 视图模型实例 (View Model Instance)

视图模型实例是具有实际数值的视图模型的活动版本。开发者可以将其视为类似于面向对象编程中的"类实例"（Class Instance）。实例具有与其派生自的视图模型相同的属性，只不过现在每个属性都有一个随时间和环境变化的活动数值。

您可以从给定的视图模型创建任意数量的实例。每个实例都可以根据其代表的含义赋予唯一的名称。每个实例的属性都可以具有不同的初始值，代表设计时的配置。例如，如果您有一个带有图标的菜单，包含三个按钮：🏠 首页、👤 个人资料和 ❓ 关于，您可能只有一个代表菜单项的画板，但有三个视图模型实例，每个实例都带有菜单项的标签和相关联的图标，这些实例可以应用到该画板以配置各个按钮。

画板被分配一个实例来填充数据绑定内容。更改所应用的实例将更改属性的初始状态以及所有相关的绑定元素。

为了使实例对开发者可见，必须将其标记为"已导出"（Exported）。否则，它被视为文件内部私有的。保持私有的一个原因是：如果您仅使用该实例来测试当配置了一组特定值（包括边缘情况）时的设计效果。

这些导出的实例随后可以由开发者在运行时分配给画板。或者，开发者可以创建具有默认值的空实例，例如数字为零，字符串为空。一旦分配了实例，其数值将根据绑定开始更新。

### 绑定 (Binding)

绑定是属性与编辑器元素之间的关联。例如，您可能有一个名为 "Name"（姓名）的属性绑定到文本运行（text run）的文本值。

绑定可以是源到目标（source to target）、目标到源（target to source）或双向（bidirectional）。在这种情况下，"源"（source）指属性，"目标"（target）指编辑器元素。

默认绑定是**源到目标**。这意味着对属性的更改会更新元素的值。例如，XPos 属性更新对象的 X 轴位置。

**目标到源**意味着对元素值的更改会更新属性。例如，对象的 X 轴位置更新 XPos 属性。

**双向**意味着更改双向应用，即元素或属性任一方的更改都可以更新另一方。

此外，绑定可以被标记为"仅绑定一次"（Bind Once）。这意味着初始值将应用，此后绑定将不再应用任何更新。

<YouTube videoId="OBmP-KxqIyU" />

### 视图模型嵌套 (View Model Nesting)

视图模型可以将另一个视图模型作为其属性之一。这被称为"嵌套"。当父实例想要与特定的子实例关联时（类似于组件），这非常有用。

### 枚举 (Enumeration / Enum)

枚举代表一组固定的选项，类似于下拉菜单。使用此属性类型可以将可用值约束为已知的、不变的一组。

枚举属性可以是"系统"枚举，在这种情况下，它们代表编辑器中一组固定的选项，如"水平对齐"选项；或者是"用户定义"枚举，在这种情况下，它们可以代表适用于您用例的任何固定选项。

### 转换器 (Converter)

转换器是在应用绑定值时对其进行转换的通用方法。这些转换可能涉及更改其类型。例如，"转换为字符串"转换器可用于将数字绑定转换为文本，以便可以将对象的 X 轴位置应用到文本运行中。

要对已有绑定的值应用转换器，请右键点击绑定属性，点击 "Update Bind"（更新绑定），并从转换器（Convert）下拉菜单中选择您的转换器。

# 与现有功能的比较

数据绑定承担了一些与 Rive 现有功能相同的角色。总的来说，它被认为是输入（Inputs）和事件（Events）更强大的替代方案，我们建议您在未来的大多数用例中采用它。然而，这并不意味着您需要对现有文件进行改造，因为它们将继续按预期工作。

### 数据类型支持

与输入和事件相比，视图模型属性可以代表更多类型的数据。参见下表进行对比。

|                      | 输入 (Inputs) | 事件 (Events) | 视图模型属性 |
| -------------------- | :------------ | :------------ | :----------- |
| 浮点数               | ✅             | ✅             | ✅            |
| 布尔值               | ✅             | ✅             | ✅            |
| 触发器 (Triggers)    | ✅             | ❌             | ✅            |
| 字符串 (Strings)     | ❌             | ✅             | ✅            |
| 枚举 (Enums)         | ❌             | ❌             | ✅            |
| 颜色 (Colors)        | ❌             | ❌             | ✅            |
| 视图模型嵌套         | ❌             | ❌             | ✅            |
| 列表 (Lists)         | ❌             | ❌             | ✅            |
| 图像 (Images)        | ❌             | ❌             | ✅            |
| 画板 (Artboards)     | ❌             | ❌             | ✅            |

### 状态机输入 (State Machine Inputs)

在数据绑定出现之前，状态机输入是开发者影响设计的主要方式。它们构成了与设计约定的"输入"方。视图模型属性是一个更灵活的系统。

输入只能用于驱动状态机转换，而数据绑定可以用于驱动 Rive 中的大多数编辑器元素以及状态机转换。

输入必须原样使用，而数据绑定属性可以在被开发者使用之前或被应用到编辑器元素之前进行转换。

视图模型属性还为开发者同时支持轮询（polling）和监听（listening）API，而输入仅支持轮询。这意味着开发者可以更自然地对数据更改做出反应。

视图模型属性还可以用于目前由输入使用的两个功能，即作为混合状态（包括一维混合和叠加混合）的混合参数，以及作为监听器的接收器，例如通过鼠标点击或轻触来设置数值。

### 事件 (Events)

与输入相对应，事件是开发者从设计接收"输出"的主要方式。数据绑定为开发者观察 Rive 设计中的数值提供了一个更为丰富的通道。此外，事件在 Rive 文件内部被用来使用监听器增加响应性。这两种用例都由属性（Properties）解决了。对于开发者，运行时 API 允许您订阅其数值的更改。对于设计师，您可以将响应元素直接绑定到属性上。

事件只能由时间轴、状态机转换或监听器触发。相比之下，数据绑定属性可以从任意数量的源头进行更改。

事件可以具有带数值的可关键帧属性，这些值在触发时传递。这局限于被动画关键帧更新，且当动画存在于组件上时，要使其"冒泡"可能会很棘手。相比之下，视图模型属性在每次更改时都携带最新数据，无论处于层级结构的哪一层，都会触发带有新值的开发者监听器。

事件提供了一个数据绑定目前尚不支持的功能用例，即播放音频的能力。

### 约束 (Constraints)

约束允许两个对象之间的一种特定绑定，例如位置的平移。约束针对此类用例进行了优化，内置了本地/世界空间转换、强度参数、最小值和最大值等选项。对于仅需要这些功能的用例，约束可能是更简洁的选择。相比之下，例如对 X 和 Y 位置进行数据绑定可以用于更广泛的输出行为，尽管可能需要一些转换器设置来实现。

### 嵌套 (Nesting)

关于嵌套，在以下几种用例中您可能需要考虑更新使用数据绑定，因为它提供了更直接的方法：

- 设置嵌套输入
- 设置嵌套文本运行
- 嵌套事件的"冒泡"

这三个用例通过视图模型实例得到了统一，组件可以从顶层视图模型获取数据。这简化了开发者的交互，因为文件画板的结构、命名和嵌套可以在不破坏代码对数据引用的情况下发生变化。

# 运行时 API

要继续阅读关于如何使用代码与数据绑定交互，请参阅[运行时概览](/runtimes/data-binding)页面。

**[数据绑定运行时概览](/runtimes/data-binding)**

  深入了解在运行时使用数据绑定。
