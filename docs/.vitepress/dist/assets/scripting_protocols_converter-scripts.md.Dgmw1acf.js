import{_ as i,c as a,o as n,ag as e}from"./chunks/framework.WXS6e2PS.js";const l="/docs/images/scripting/create-converter-with-script.png",g=JSON.parse('{"title":"转换器脚本 (Converter Scripts)","description":"使用 Rive 脚本创建自定义转换器","frontmatter":{"title":"转换器脚本 (Converter Scripts)","description":"使用 Rive 脚本创建自定义转换器"},"headers":[],"relativePath":"scripting/protocols/converter-scripts.md","filePath":"scripting/protocols/converter-scripts.md"}'),p={name:"scripting/protocols/converter-scripts.md"};function t(r,s,h,k,d,c){return n(),a("div",null,[...s[0]||(s[0]=[e(`<p>Rive 包含几个内置转换器，如 <strong>转换为字符串 (Convert to String)</strong> 和 <strong>进位 (Round)</strong>。 当内置转换器无法满足您的需求时，可以使用脚本创建自定义转换器。</p><p>有关转换器和数据绑定的背景知识，请参阅 <a href="/docs/editor/data-binding/overview#converter">数据转换器 (Data Converters)</a>。</p><h2 id="示例-examples" tabindex="-1">示例 (Examples) <a class="header-anchor" href="#示例-examples" aria-label="Permalink to &quot;示例 (Examples)&quot;">​</a></h2><h2 id="创建转换器-creating-a-converter" tabindex="-1">创建转换器 (Creating a Converter) <a class="header-anchor" href="#创建转换器-creating-a-converter" aria-label="Permalink to &quot;创建转换器 (Creating a Converter)&quot;">​</a></h2><p><a href="/docs/scripting/creating-scripts">创建一个新脚本</a> 并选择 <strong>Converter</strong> 作为类型。</p><h2 id="转换器脚本的结构-anatomy-of-a-converter-script" tabindex="-1">转换器脚本的结构 (Anatomy of a Converter Script) <a class="header-anchor" href="#转换器脚本的结构-anatomy-of-a-converter-script" aria-label="Permalink to &quot;转换器脚本的结构 (Anatomy of a Converter Script)&quot;">​</a></h2><div class="language-lua vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">lua</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> MyConverter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 在脚本初始化时调用一次。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MyConverter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): boolean</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 将绑定的属性值从源转换为目标。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> convert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MyConverter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, input: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataValueNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): DataValueNumber</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  local</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: DataValueNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataValue.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    -- 将输入的数值加 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    dv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :: DataValueNumber).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dv</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 从目标转换回源（用于目标到源和双向数据绑定）。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> reverseConvert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MyConverter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, input: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">DataValueNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): DataValueNumber</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  local</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> dv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: DataValueNumber </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> DataValue.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isNumber</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    dv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> :: DataValueNumber).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dv</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 返回一个构建转换器实例的工厂函数。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- Rive 在创建脚本时会调用此函数，并返回一个包含其生命周期函数和任何默认值的表。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): Converter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MyConverter, DataValueNumber, DataValueNumber</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    init </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> init,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    convert </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> convert,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reverseConvert </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> reverseConvert,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="使用脚本创建转换器-creating-a-converter-using-your-script" tabindex="-1">使用脚本创建转换器 (Creating a Converter using your Script) <a class="header-anchor" href="#使用脚本创建转换器-creating-a-converter-using-your-script" aria-label="Permalink to &quot;使用脚本创建转换器 (Creating a Converter using your Script)&quot;">​</a></h2><p>使用您的新转换器脚本创建一个新转换器：</p><ol><li>在“数据 (Data)”面板中，点击 <code>+</code> 按钮。</li><li>选择 <strong>Converters → Script → MyConverter</strong>。</li></ol><p><img src="`+l+'" alt="使用脚本创建转换器"></p><h2 id="添加输入-adding-inputs" tabindex="-1">添加输入 (Adding Inputs) <a class="header-anchor" href="#添加输入-adding-inputs" aria-label="Permalink to &quot;添加输入 (Adding Inputs)&quot;">​</a></h2><p>请参阅 <a href="/docs/scripting/script-inputs">脚本输入 (Script Inputs)</a>。</p>',13)])])}const o=i(p,[["render",t]]);export{g as __pageData,o as default};
