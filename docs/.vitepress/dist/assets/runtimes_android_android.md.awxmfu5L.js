import{_ as a,C as n,c as e,o as p,G as l,ag as t}from"./chunks/framework.WXS6e2PS.js";const u=JSON.parse('{"title":"Android","description":"Rive 的 Android 运行时。","frontmatter":{"title":"Android","description":"Rive 的 Android 运行时。"},"headers":[],"relativePath":"runtimes/android/android.md","filePath":"runtimes/android/android.md"}'),r={name:"runtimes/android/android.md"};function h(k,s,d,o,E,c){const i=n("NoteOnFeatureSupport");return p(),e("div",null,[l(i),s[0]||(s[0]=t(`<h2 id="概述-overview" tabindex="-1">概述 (Overview) <a class="header-anchor" href="#概述-overview" aria-label="Permalink to &quot;概述 (Overview)&quot;">​</a></h2><p>欢迎在 Android 上使用 Rive。Rive 运行时库是开源的，Android 版本可以在 <a href="https://github.com/rive-app/rive-android" target="_blank" rel="noreferrer">rive-android</a> GitHub 仓库中找到。</p><h3 id="关于-android-api-的说明" tabindex="-1">关于 Android API 的说明 <a class="header-anchor" href="#关于-android-api-的说明" aria-label="Permalink to &quot;关于 Android API 的说明&quot;">​</a></h3><p>适用于 Android 的 Rive 提供了两个主要的 API，用于将 Rive 集成到您的应用程序中。</p><p><strong>旧版基于 View 的 API (Legacy View-based API)</strong></p><p>该 API 基于 Android View 和 XML 布局。它很稳定，并已在生产应用中广泛部署。它还支持 <a href="https://github.com/rive-app/rive-android/blob/master/app/src/main/java/app/rive/runtime/example/LegacyComposeActivity.kt" target="_blank" rel="noreferrer">通过使用 AndroidView 的 Compose</a>，尽管这需要一些样板代码来设置。</p><p>该 API 的入口点是 <code>RiveAnimationView</code>，它可以添加到您的 XML 布局中或以编程方式实例化。</p><p>我们将其称为“旧版”API，因为我们未来的开发重点是新的 Compose API，但该 API 将在一段时间内继续得到支持和维护。</p><p><strong>新版 Compose API (技术预览版)</strong></p><p>该 API 专为 Jetpack Compose 设计，允许使用更现代和声明式的方法来构建 UI。它目前处于技术预览阶段，这意味着它仍在积极开发中，并且在未来的版本中可能会有破坏性变更。<strong>目前不建议在生产环境中使用</strong>。我们非常鼓励提供关于此 API 的反馈，以帮助我们改进它。</p><p>该 API 的入口点是 <code>RiveUI</code> 可组合函数，它可以直接在您的 Compose UI 代码中使用。</p><p>除了提供更符合 Compose 习惯的体验外，该 API 还由更强大的线程模型驱动，具有更高的稳定性和灵活性，可以将 Rive 工作分散到多个线程中。</p><h2 id="示例应用-example-app" tabindex="-1">示例应用 (Example App) <a class="header-anchor" href="#示例应用-example-app" aria-label="Permalink to &quot;示例应用 (Example App)&quot;">​</a></h2><p>要探索 Android API，您可以运行我们的 Android 示例应用。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/rive-app/rive-android</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>在 Android Studio 中打开克隆的文件夹，选择 <code>app</code> 配置和目标设备。通过打开菜单 <code>Build - Select Build Variant...</code> 并为 <code>app</code> 选择 <code>preview (default)</code> 变体，确保构建变体设置为 <code>preview (default)</code>。</p><p>其他构建变体用于开发目的，需要额外的配置。参见 <a href="https://github.com/rive-app/rive-android/blob/master/CONTRIBUTING.md" target="_blank" rel="noreferrer">CONTRIBUTING.MD</a>。</p><h2 id="入门-getting-started" tabindex="-1">入门 (Getting Started) <a class="header-anchor" href="#入门-getting-started" aria-label="Permalink to &quot;入门 (Getting Started)&quot;">​</a></h2><p>按照以下步骤开始将 Rive 集成到您的 Android 应用中。</p><h3 id="添加-rive-依赖项" tabindex="-1">添加 Rive 依赖项 <a class="header-anchor" href="#添加-rive-依赖项" aria-label="Permalink to &quot;添加 Rive 依赖项&quot;">​</a></h3><p>在项目的 <code>build.gradle</code> 文件中添加以下依赖项。我们建议使用最新版本的 Rive Android 运行时，可以在 <a href="https://central.sonatype.com/artifact/app.rive/rive-android" target="_blank" rel="noreferrer">Maven Central</a> 上找到。</p><div class="language-groovy vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        ..</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;app.rive:rive-android:&lt;Latest Version&gt;&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 对于初始化，您可能需要添加对 Jetpack Startup 的依赖</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.startup:startup-runtime:1.1.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="初始化-rive" tabindex="-1">初始化 Rive <a class="header-anchor" href="#初始化-rive" aria-label="Permalink to &quot;初始化 Rive&quot;">​</a></h3><p>Rive 需要链接并初始化其 C++ 运行时，以便其 Kotlin 绑定能够工作。</p><p>这可以通过 <a href="https://developer.android.com/topic/libraries/app-startup" target="_blank" rel="noreferrer">initializer</a> 来完成，它在应用启动时自动执行此操作。初始化提供程序可以直接在应用的清单 (manifest) 文件中设置：</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">manifest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ...&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">provider</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.startup.InitializationProvider&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          android:authorities</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;\${applicationId}.androidx-startup&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          android:exported</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;false&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          tools:node</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;merge&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">meta-data</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;app.rive.runtime.kotlin.RiveInitializer&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">              android:value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.startup&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">provider</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">application</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">manifest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>或者，也可以在代码中调用初始化程序来实现：</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    AppInitializer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(applicationContext)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">initializeComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(RiveInitializer::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.java)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果您想自己初始化 Rive，可以在代码中使用以下方式完成。这是最灵活的选项，因为您可以延迟加载原生库，但请务必在使用任何 Rive 功能之前调用它。</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Rive.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">init</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="将-riveanimation-添加到布局中" tabindex="-1">将 RiveAnimation 添加到布局中 <a class="header-anchor" href="#将-riveanimation-添加到布局中" aria-label="Permalink to &quot;将 RiveAnimation 添加到布局中&quot;">​</a></h3><p>您现在可以将 <code>RiveAnimationView</code> 添加到布局中，或以编程方式创建它。有关各种设置方式的更多详细信息，请参见 <a href="#构建-riveanimationview-building-a-riveanimationview">构建 RiveAnimationView</a>。</p><h2 id="构建-riveanimationview-building-a-riveanimationview" tabindex="-1">构建 RiveAnimationView (Building a RiveAnimationView) <a class="header-anchor" href="#构建-riveanimationview-building-a-riveanimationview" aria-label="Permalink to &quot;构建 RiveAnimationView (Building a RiveAnimationView)&quot;">​</a></h2><p>有多种方法可以将 Rive 动画添加到您的 Android 应用中。</p><p>在开始之前，请确保您的 Rive 文件 (.riv) 已包含在 Android 项目中。推荐的方法是将它们添加到项目的原始资源 (<code>res/raw</code>) 文件夹中。</p><h4 id="使用-setriveresource-或-setriveurl" tabindex="-1">使用 setRiveResource 或 setRiveUrl <a class="header-anchor" href="#使用-setriveresource-或-setriveurl" aria-label="Permalink to &quot;使用 setRiveResource 或 setRiveUrl&quot;">​</a></h4><p>对于最简单的编程初始化，请使用 <code>setRiveResource</code>（本地）或 <code>setRiveUrl</code>（网络）方法。它们有多个可选参数来自定义视图。</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MyActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ComponentActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(savedInstanceState: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bundle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(savedInstanceState)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> riveView </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RiveAnimationView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        riveView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setRiveResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.raw.my_rive_file)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // 或</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        riveView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setRiveUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://mycdn.myorg.com/my_rive_file.riv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(riveView)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="使用-riveanimationview-builder" tabindex="-1">使用 RiveAnimationView.Builder <a class="header-anchor" href="#使用-riveanimationview-builder" aria-label="Permalink to &quot;使用 RiveAnimationView.Builder&quot;">​</a></h4><p>Rive 还提供了一种用于构建 <code>RiveAnimationView</code> 的构建器模式，它允许分阶段初始化步骤。请注意，<code>setResource</code> 方法可以接受原始资源 ID、URL（字符串）、字节数组或 Rive <code>File</code>。</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> riveView </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RiveAnimationView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Builder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.raw.my_rive_file)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 或</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://mycdn.myorg.com/my_rive_file.riv&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(riveView)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="使用-rive-文件-using-a-rive-file" tabindex="-1">使用 Rive 文件 (Using a Rive File) <a class="header-anchor" href="#使用-rive-文件-using-a-rive-file" aria-label="Permalink to &quot;使用 Rive 文件 (Using a Rive File)&quot;">​</a></h4><p>如果您已经加载了 Rive <code>File</code> 实例，也可以使用它来初始化视图。有关如何以及为何加载 Rive 文件的更多详细信息，请参见 <a href="./../caching-a-rive-file">缓存 Rive 文件</a>。</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 为简单起见，在主线程加载字节；在生产环境请考虑在后台线程加载。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bytes </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> resources.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openRawResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.raw.rating).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { res </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> res.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">readBytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> riveFile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(bytes)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> riveView </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> RiveAnimationView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">riveView.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setRiveFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(riveFile)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 如果不再需要文件则释放它，如果打算重用它则保留它。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">riveFile.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">release</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(riveView)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="使用-compose-androidview" tabindex="-1">使用 Compose (AndroidView) <a class="header-anchor" href="#使用-compose-androidview" aria-label="Permalink to &quot;使用 Compose (AndroidView)&quot;">​</a></h4><p>您还可以使用 <code>AndroidView</code> 可组合组件在 Compose UI 中使用 <code>RiveAnimationView</code>。另请参阅示例应用中的 <a href="https://github.com/rive-app/rive-android/blob/master/app/src/main/java/app/rive/runtime/example/LegacyComposeActivity.kt" target="_blank" rel="noreferrer">LegacyComposeActivity</a>。</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setContent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    AndroidView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        factory </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { context </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            RiveAnimationView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">also</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                it.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setRiveResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.raw.my_rive_file)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="使用-xml" tabindex="-1">使用 XML <a class="header-anchor" href="#使用-xml" aria-label="Permalink to &quot;使用 XML&quot;">​</a></h4><p>要使用 XML，请将其作为布局的一部分包含在内。它具有多个可选属性来自定义视图。</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">app.rive.runtime.kotlin.RiveAnimationView</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    android:layout_width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;match_parent&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    android:layout_height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;match_parent&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    app:riveResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@raw/my_rive_file&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ... /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果您更愿意从托管位置加载 Rive 文件，请使用 <code>app:riveUrl</code> 属性。确保您已获得必要的 <a href="#互联网权限-internet-permissions">互联网权限</a>。</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">app.rive.runtime.kotlin.RiveAnimationView</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    app:riveUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://mycdn.myorg.com/my_rive_file.riv&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ... /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>从 Activity 中，您可以像往常一样加载它：</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.layout.my_layout)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="互联网权限-internet-permissions" tabindex="-1">互联网权限 (Internet Permissions) <a class="header-anchor" href="#互联网权限-internet-permissions" aria-label="Permalink to &quot;互联网权限 (Internet Permissions)&quot;">​</a></h3><p>如果您是通过网络检索 Rive 文件，您的应用需要在 <code>AndroidManifest.xml</code> 中获得访问互联网的权限：</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses-permission</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.permission.INTERNET&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses-permission</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>请注意，如果您将 .riv 文件包含在 Android 项目中并作为原始资源加载，则不需要这样做。</p><p>参见“运行时基础”部分的页面，了解如何控制动画播放、状态机等。</p><h2 id="资源-resources" tabindex="-1">资源 (Resources) <a class="header-anchor" href="#资源-resources" aria-label="Permalink to &quot;资源 (Resources)&quot;">​</a></h2><p><a href="https://github.com/rive-app/rive-android" target="_blank" rel="noreferrer">GitHub</a></p><p><a href="https://github.com/rive-app/rive-android/tree/master/app/src/main/java/app/rive/runtime/example" target="_blank" rel="noreferrer">示例 (Examples)</a></p>`,62))])}const b=a(r,[["render",h]]);export{u as __pageData,b as default};
